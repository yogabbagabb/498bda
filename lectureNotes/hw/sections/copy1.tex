\documentclass[../main.tex]{subfiles}



%% Local Macros and packages: add any of your own definitions here.

\begin{document}

% Homework number, your name and NetID, and optionally, the names/NetIDs of anyone you collaborated with. If you did not collaborate with anybody, leave the last parameter empty.
\homework
    {0}
    {Aahan Agrawal (agrawl10)}
    {Some Person (sperson2), Another Person (aperson3)}

\section*{Problem (1)}
\textbf{Solution:} 

We will repeatedly use the fact that if $\sigma(z) = \frac{1}{1 + \exp(-z)}$ then\[ \frac{\partial}{\partial z}\sigma(z) = \frac{\exp(-z)}{\left(1 + \exp(-z)\right)^2} \]
(a)\\

Let $z = w^Tx^{i}$ and compute the gradient:

\begin{align*}
    \nabla f = \frac{1}{2n}\sum_{i \in [n]}^{}2\left[y^{i} - \sigma(w^Tx^{i})\right] \cdot \frac{\partial}{\partial z}(-\sigma(z)) \cdot \frac{\partial}{\partial w}(w^Tx^{(i)}) \\
    = \frac{1}{2n}\sum_{i \in [n]}^{}2\left[y^{i} - \sigma(w^Tx^{i})\right] \cdot  \frac{- \exp(-z)}{\left(1 + \exp(-z)\right)^2} \cdot \left(x^{(i)}\right)^T \\
    = \frac{1}{n}\sum_{i \in [n]}^{}\left[y^{i} - \sigma(w^Tx^{i})\right] \cdot  \frac{- \exp(-w^Tx^{i})}{\left(1 + \exp(-w^Tx^{i})\right)^2} \cdot \left(x^{(i)}\right)^T \\
    \intertext{The update rule is} \\
    w_{i+1} = w_{i} - \alpha \nabla f \\
    \intertext{where $\alpha$ is some step size} \\
\end{align*}

(b) \\

Let $z = y^{i}w^Tx^{i}$ and compute the gradient:
\begin{align*}
    \nabla f = \frac{1}{n}\sum_{i \in [n]}^{}\frac{-1}{\sigma(y^{i}w^Tx^{i})} \cdot \frac{\partial}{\partial z}\sigma(z) \cdot \frac{\partial}{\partial w}y^{i}w^{T}x^{i} \\ 
    = \frac{-1}{n}\sum_{i \in [n]}^{}\frac{1}{\sigma(y^{i}w^Tx^{i})} \cdot \frac{-\exp(-z)}{\left(1 + \exp(-z)\right)^2}  \cdot y^{i}\left(x^{i}\right)^T \\ 
    = \frac{1}{n}\sum_{i \in [n]}^{}\frac{1}{\sigma(y^{i}w^Tx^{i})} \cdot \frac{\exp(-y^{i}w^Tx^{i})}{\left(1 + \exp(-y^{i}w^Tx^{i})\right)^2}  \cdot y^{i}\left(x^{i}\right)^T \\ 
    = \frac{1}{n}\sum_{i \in [n]}^{}\frac{1 + \exp(-y^{i}w^Tx^{i})}{1} \cdot \frac{\exp(-y^{i}w^Tx^{i})}{\left(1 + \exp(-y^{i}w^Tx^{i})\right)^2}  \cdot y^{i}\left(x^{i}\right)^T \\ 
    = \frac{1}{n}\sum_{i \in [n]}^{}\frac{\exp(-y^{i}w^Tx^{i})}{\left(1 + \exp(-y^{i}w^Tx^{i})\right)}  \cdot y^{i}\left(x^{i}\right)^T \\ 
    = \frac{1}{n}\sum_{i \in [n]}^{}\frac{1}{\left(1 + \exp(y^{i}w^Tx^{i})\right)}  \cdot y^{i}\left(x^{i}\right)^T \tag{$\gamma$}\\ 
    \intertext{The update rule is} \\
    w_{i+1} = w_{i} - \alpha \nabla f \\
    \intertext{where $\alpha$ is some step size} \\
\end{align*}


(c) \\

Take the Jacobian of $(\gamma)$ and then the transpose of that result (this will give us the Hessian):

\begin{align*}
    H f = \frac{1}{n}\sum_{i\in [n]}^{}\frac{-1 y^{i}x^{i}}{\left(1 + \exp(y^{i}w^Tx^{i})\right)^2}\cdot y^{i}\left(x^{i}\right)^T \\
    = \frac{1}{n}\sum_{i\in [n]}^{}\frac{-1 x^{i}}{\left(1 + \exp(y^{i}w^Tx^{i})\right)^2}\cdot \left(x^{i}\right)^T \\
    \intertext{Something smells} \\
\end{align*}




\newpage \nocite{*}
\bibliographystyle{ims}
\bibliography{citations}

\end{document}
